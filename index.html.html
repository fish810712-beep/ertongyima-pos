<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>二童一馬 POS｜完整版</title>
<style>
body{
  font-family:-apple-system,BlinkMacSystemFont,"PingFang TC";
  background:#fff3e6;margin:0;padding:12px
}
h1{text-align:center;color:#ff6f4f}
.wrap{display:flex;gap:12px;flex-wrap:wrap}
.panel{
  flex:1 1 320px;
  background:#fff;border-radius:14px;padding:12px
}
.price-grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:8px;
}
.price-btn{
  border:none;border-radius:12px;
  padding:16px 0;
  font-size:18px;
  background:#ffd2c2;
}
.total{font-size:22px;color:#ff4f2f}
.list{max-height:260px;overflow:auto;font-size:18px}
input{
  width:100%;padding:12px;font-size:18px;
  border-radius:10px;border:1px solid #ccc
}
.action{
  width:100%;margin-top:6px;
  background:#ff9a7a;color:#fff
}
</style>
</head>
<body>

<h1>二童一馬 POS</h1>

<div class="wrap">

<div class="panel">
<h3>內建金額（全顯示）</h3>
<div class="price-grid" id="priceBtns"></div>
<hr>
<h3>刷條碼</h3>
<input id="barcode" placeholder="刷條碼後自動加入（Enter）">
</div>

<div class="panel">
<h3>結帳欄</h3>
<div class="list" id="list"></div>
<p>總件數：<b id="count">0</b></p>
<p class="total">總金額：$<span id="total">0</span></p>
<button class="action" onclick="checkout()">完成結帳</button>
<button class="action" onclick="exportCSV()">匯出 Excel</button>
</div>

</div>

<script>
const prices=[
100,150,200,250,290,
300,350,390,400,450,
490,500,550,590,600,
650,690,700,750,790
];

let items=JSON.parse(localStorage.getItem("items")||"[]");

function save(){localStorage.setItem("items",JSON.stringify(items))}

function render(){
document.getElementById("list").innerHTML=items.map(p=>"$"+p).join("<br>");
document.getElementById("count").innerText=items.length;
document.getElementById("total").innerText=items.reduce((a,b)=>a+b,0);
}

prices.forEach(p=>{
let b=document.createElement("button");
b.className="price-btn";
b.innerText="$"+p;
b.onclick=()=>{items.push(p);save();render();};
document.getElementById("priceBtns").appendChild(b);
});

document.getElementById("barcode").addEventListener("keydown",e=>{
if(e.key==="Enter"){
let v=parseInt(e.target.value);
if(!isNaN(v)){items.push(v);save();render();}
e.target.value="";
}
});

function checkout(){
items=[];save();render();alert("結帳完成");
}

function exportCSV(){
let csv="金額\n"+items.join("\n");
let blob=new Blob([csv],{type:"text/csv"});
let a=document.createElement("a");
a.href=URL.createObjectURL(blob);
a.download="二童一馬_結帳紀錄.csv";
a.click();
}

render();
</script>
</body>
</html>
